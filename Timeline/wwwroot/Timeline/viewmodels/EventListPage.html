<link rel="import" href="/sys/polymer/polymer.html">
<link rel="import" href="/Timeline/elements/timeline-date-point" />
<link rel="stylesheet" href="/Timeline/css/TimelineStyles.css">

<template>
    <template is="dom-bind">
        <div class="timeline-column-container timeline-placement">
            <div class="timeline-row-container">
                <div class="timeline-line">
                    <div class="timeline-line__vertical-line"></div>
                    <div class="timeline-line__horizontal-line"></div>
                </div>
                <!--<template is="dom-repeat" items="{{model.EventGroups}}" as="group">
            <timeline-date-point date="{{group.Date}}" style="margin-top: 10px;"></timeline-date-point>

            <template is="dom-repeat" items="{{group.Events}}" as="eventItem">
                <div style="display: flex; flex-direction: row; justify-content: flex-start;">
                    <div style="display: flex; align-items: center; justify-content: center; width: 40px; height: 40px; margin-top: 40px;">
                        <div class="timeline-icon-shopping--inverse" style="background-color: black; height: 30px; width: 30px; border-radius: 25px; box-shadow: 0 0 5px 0 black;">

                        </div>
                    </div>

                    <div class="timeline-event-wrapper">
                        <div class="timeline-event-wrapper__title-container">
                            <p class="timeline-event-wrapper__title"> {{eventItem.DisplayedDate}} {{CheckIfEmpty(eventItem.Participant)}}</p>
                            <button class="timeline-hover-button timeline-icon-edit" value="{{eventItem.EditTrigger$::click}}" onmousedown="++this.value"></button>
                            <button class="timeline-hover-button timeline-icon-close" value="{{eventItem.DeleteTrigger$::click}}" onmousedown="++this.value"></button>
                            <p class="timeline-event-wrapper__title"> {{eventItem.Name}} </p>
                        </div>

                        <div class="timeline-event-content">
                            <starcounter-include partial="{{eventItem.TimelineEventPage}}"></starcounter-include>
                        </div>
                    </div>
                </div>
            </template>
        </template>-->

                <div class="timeline-column-container timeline-bottom-spacing">
                    <template is="dom-repeat" items="{{model.Events}}">
                        <template is="dom-if" if="{{item.DisplayBreak}}">
                            <timeline-date-point date="{{item.Date}}"></timeline-date-point>
                        </template>

                        <div class="timeline-row-container timeline-event-wrapper">
                            <div class="timeline-event-icon-container">
                                <div class="timeline-event-icon-background">
                                    <div class$="timeline-icon-default timeline-icon-{{DecideIcon(item.Name)}}"></div>
                                </div>
                            </div>

                            <div class="timeline-event">
                                <div class="timeline-event__title-container">
                                    <p class="timeline-event__title">{{item.DisplayedDate}}</p>
                                    <button class="timeline-hover-button timeline-icon-edit" value="{{item.EditTrigger$::click}}" onmousedown="++this.value"></button>
                                    <button class="timeline-hover-button timeline-icon-close" value="{{item.DeleteTrigger$::click}}" onmousedown="++this.value"></button>
                                    <p class="timeline-event__title">{{item.Name}}</p>
                                </div>

                                <div class="timeline-row-container">
                                    <div class="timeline-event-pointer" style$="border-right-color:{{item.EventInfo.Color}}"></div>
                                    <div class="timeline-event-content">
                                        <starcounter-include partial="{{item.TimelineEventPage}}"></starcounter-include>
                                    </div>
                                </div>

                                <p class="timeline-event__title"><i class="fa fa-circle-o" aria-hidden="true"></i> {{CheckIfEmpty(item.Participant)}}</p>

                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </div>
    </template>
    <script>
        (function () {
            var script = document._currentScript || document.currentScript;
            var template = script.previousElementSibling;

            template.CheckIfEmpty = function (participant) {
                if (participant == null || participant.length == 0) {
                    return "All";
                } else {
                    return participant;
                }
            };

            template.DecideIcon = function (icon) {
                if (icon.length <= 0) {
                    return "default";
                }
                return icon.toLowerCase();
            };
        })();
    </script>
</template>